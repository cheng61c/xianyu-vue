import{u as t}from"../../store-global/configStore-CQ7TO-i0.js";import{u as e}from"../user/userStore-CYZokpSa.js";import{a as s,c as a,t as o,b as r,e as n}from"../../lucide-vue-next-DYmFLWJU.js";import{u as i}from"../post/postStore-7aBFqooK.js";const p=t(),l=p.serverAddress,d=e(),u=s.create({baseURL:l,timeout:6e5,headers:{"Content-Type":"application/json"}});u.interceptors.request.use(t=>{const e=d.token;return e&&(t.headers.Authorization=`Bearer ${e}`),p.loading=!0,t},t=>Promise.reject(t)),u.interceptors.response.use(t=>(p.loading=!1,t),t=>{const{response:e}=t,s=t;if(e){const t=e.data;s.msg=t.message||t.msg||"未知错误",s.duplicates=t.duplicates||[],s.status=e.status}else s.msg="服务器无响应",s.status=500;return p.loading=!1,Promise.reject(s)});const c=()=>u.get("/plate/list"),m=t=>u.post("/plate",t),g=t=>u.put("/plate",t),f=t=>u.post("/admin/plate/disabled",t),h=()=>u.get("/admin/plate"),$=()=>u.get("/hall-of-fame"),y=()=>u.get("/hall-of-fame/list"),b=t=>u.delete(`/hall-of-fame/${t}`),S=Object.freeze(Object.defineProperty({__proto__:null,createFengYunBang:t=>{const{id:e,...s}=t;return u.post("/hall-of-fame",s)},deleteFengYunBang:b,getFengYunBangAll:$,getFengYunBangList:y,updateFengYunBang:t=>u.put("/hall-of-fame",t)},Symbol.toStringTag,{value:"Module"})),v=()=>u.get("/notification/unread"),P=t=>u({url:"/notification/list",method:"get",params:t}),w=()=>u.post("/notification/readByAll"),x=t=>u.post("/motd",t),D=t=>u.put("/motd",t),j=()=>u.get("/admin/motd"),A=t=>u({method:"get",url:"/post/list",params:t}),T=t=>u({method:"get",url:"/post/top",params:{type:t}}),F=t=>u.get(`/post/detail?id=${t}`),M=t=>u.put("/post",t),k=t=>u.delete(`/post/${t}`),z=t=>u.post("/post/like",{id:t}),C=t=>u.post("/post/bad",{id:t}),B=t=>u.get(`/post/search?title=${t}&page=1&limit=30&type=2`),_=({id:t})=>u.get(`/post-version/list?postId=${t}`),L=t=>u.get(`/post-version/info?id=${t}`),N=t=>u.delete(`/post-version/${t}`),E=t=>u.put("/admin/post",t),I=t=>u.delete("/admin/post/disabled",{data:t}),R=t=>u.post("/post/top",t),O=t=>u({method:"GET",url:"/admin/post/list",params:t}),q=Object.freeze(Object.defineProperty({__proto__:null,createPost:t=>u.post("/post",t),createServerPost:t=>u.post("/server-post",t),createVersion:t=>u.post("/post-version",t),deleteComment:t=>u.delete(`/post-comment/${t}`),deletePost:k,deletePostAsAdmin:I,deleteVersion:N,getPostComment:(t,e)=>u.get(`/post-comment/postId?postId=${t}&orderType=${e?"2":"1"}`),getPostDetail:F,getPostDocumentList:_,getPostList:A,getPostListTop:T,getResourceDetail:L,getServerPostList:t=>u({method:"get",url:"/server-post/list",params:t}),postBad:C,postCommentBad:t=>u.post("/post-comment/bad",{id:t}),postCommentLike:t=>u.post("/post-comment/like",{id:t}),postDisabled:t=>u.post("/admin/post/disabled",t),postLike:z,postListAsAdmin:O,postToTopAsAdmin:R,replyPost:t=>u.post("/post-comment",t),searchPost:B,updatePost:M,updatePostAsAdmin:E,updateServerPost:t=>u.put("/server-post",t),updateVersion:t=>u.put("/post-version",t)},Symbol.toStringTag,{value:"Module"})),Y=()=>u.get("/role/list"),G=()=>u.get("/admin/role/list"),H=t=>u.put("/admin/role/update",t),U=t=>u.post("/role",t),V=t=>u.post("/user/login",t),W=t=>u.post("/user/register",t),K=t=>u.post("/verification-code/send",t),X=t=>u.post("/user/update-password",t),Z=()=>u.post("/user/logout"),J=t=>u.put("/user/update",t),Q=()=>u.put("/user/update-key"),tt=t=>u.put("/user/update-verify-code",{code:t}),et=t=>u({method:"get",url:"/user/posts",params:t}),st=()=>u.get("/user/info"),at=t=>u.get(`/user/${t}`),ot=t=>u({method:"GET",url:"/admin/user/list",params:t}),rt=t=>u.post("/admin/user/disabled",t),nt=t=>u.put("/admin/user/update",t),it=t=>u.put("/admin/user/update-roles",t),pt=t=>u.put(`/admin/user/update-key/${t}`),lt=t=>u.post("/user/register-bot",t),dt=t=>u.post("/server-post",t),ut=t=>u.put("/server-post",t),ct=t=>u.delete(`/server-post/${t}`),mt=t=>u.get("/user/server-posts",t),gt=t=>u.delete(`/server-post/${t.id}`,{data:{disabled:t.disabled}}),ft=t=>u({method:"GET",url:"/admin/server-post/list",params:t}),ht=t=>u.put("/admin/server-post/update",t),$t=t=>u.post("/server-post/test/ping",{url:t}),yt=async(a,o,r=2097152,n)=>{const i=t(),p=e();return new Promise((t,e)=>{const l=Math.ceil(a.size/r);let d=null;const u=async c=>{try{const e=c*r,m=Math.min(e+r,a.size),g=a.slice(e,m),f=new FormData;f.append("chunk",g),f.append("chunkIndex",c.toString()),f.append("totalChunks",l.toString()),f.append("filename",a.name),void 0!==o&&f.append("type",o.toString());const h=await s.post(i.uploadAddress,f,{headers:{Authorization:`Bearer ${p.token}`}});d=h,n&&n(c+1,l),c<l-1?await u(c+1):t(d)}catch(m){e(m)}};u(0)})},bt=t=>u({method:"get",url:"/upload/list",params:t}),St=()=>u.get("/version/list"),vt=(t,e)=>u.put("/version/"+t,e),Pt=t=>u.delete("/version/"+t),wt=t=>u.post("/version",t),xt=t=>u.post("/version",t),Dt=()=>u.get("/admin/version/list"),jt=t=>u.get("/post-comment/list",{data:t}),At=t=>u({url:"/post-comment/postId",method:"get",params:t}),Tt=t=>u.post("/post-comment",t),Ft=t=>u.post("/post-comment/like",t),Mt=t=>u.delete("/post-comment/"+t),kt=a({csharp:n}),zt=t(),Ct=i(),Bt=t=>t&&""!==t?String(t).replace(/<img[^>]*>/gi,"[图片]").replace(/<video[^>]*>.*?<\/video>/gis,"[视频]").replace(/<a\s+[^>]*href=['"][^'"]+['"][^>]*>.*?<\/a>/gis,"[链接]").replace(/<[^>]+>/g,"").replace(/&nbsp;|&amp;|&lt;|&gt;|&quot;|&#39;|&#x27;|&#x2F;|&#x60;|&#x3D;/g,""):"",_t=(t,e)=>{let s;if(t instanceof Date)s=t;else if("number"==typeof t||"string"==typeof t&&/^\d+$/.test(t)){const e="number"==typeof t?t:parseInt(t,10);s=10===e.toString().length?new Date(1e3*e):(e.toString().length,new Date(e))}else s=new Date(t);if(isNaN(s.getTime()))return"Invalid Date";const a=new Date;return a.setHours(0,0,0,0),s.setHours(0,0,0,0),a.getTime()===s.getTime()?Nt(t.toString(),e):Lt(t)},Lt=t=>{let e;if(t instanceof Date)e=t;else if("number"==typeof t||"string"==typeof t&&/^\d+$/.test(t)){const s="number"==typeof t?t:parseInt(t,10);e=10===s.toString().length?new Date(1e3*s):(s.toString().length,new Date(s))}else e=new Date(t);if(isNaN(e.getTime()))return"Invalid Date";const[s,a,o,r,n]=[e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes()],i=t=>t.toString().padStart(2,"0");return s===(new Date).getFullYear()?`${i(a)}-${i(o)} ${i(r)}:${i(n)}`:`${s}-${i(a)}-${i(o)} ${i(r)}:${i(n)}`},Nt=(t,e)=>{const s="string"==typeof t&&/^\d+$/.test(t)?new Date(Number(t)).getTime():new Date(t).getTime(),a=Math.floor((Date.now()-s)/1e3),{floor:o}=Math,r=[[a<60,e("b.gang-gang")],[a<3600,e("b.floorsec-60-fen-zhong-qian",[o(a/60)])],[a<86400,e("b.floorsec-3600-xiao-shi-qian",[o(a/3600)])],[a<2592e3,e("b.floorsec-86400-tian-qian",[o(a/86400)])],[a<31536e3,e("b.floorsec-2592000-ge-yue-qian",[o(a/2592e3)])],[!0,e("b.floorsec-31536000-nian-qian",[o(a/31536e3)])]];return r.find(([t])=>t)?.[1]??e("b.gang-gang")},Et=(t,e=1)=>{const s="string"==typeof t?parseFloat(t):t;if(s<1e3)return s.toString();const a=["k","M","B","T"],o=Math.floor(Math.log(s)/Math.log(1e3)),r=Math.min(Math.max(o,1),a.length),n=s/Math.pow(1e3,r),i=n%1==0?0:e;return`${n.toFixed(i)}${a[r-1]}`},It=t=>{const e="string"==typeof t?parseFloat(t):t;return e>99?"99+":e.toString()},Rt=(t,e=!1)=>t?/^(https?|blob):\/\//i.test(t)?t:/^[a-zA-Z0-9.-]+$/.test(t)?`${window.location.protocol}//${t}`:/^(https?:\/\/)?(localhost|127\.0\.0\.1|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})/.test(t)?`${zt.serverAddress}/${t}`:(t.startsWith("./")&&(t=t.substring(2)),e&&(t=t.replace(/\/upload/,"/upload/download")),`${zt.serverAddress}${t.startsWith("/")?"":"/"}${t}`):"",Ot=t=>{const e=qt(t);if(e){const s=e.replace(/&#x3C;/g,"<").replace(/&#x26;/g,"&"),a=kt.highlight("csharp",s),r=o(a,{allowDangerousHtml:!0});return t.replace(/<pre.*><code>.*?<\/code><\/pre>/s,`<pre class="language-typescript"><code>${r}</code></pre>`)}return t},qt=t=>{const e=t.match(/<pre.*><code>(.*?)<\/code><\/pre>/s);return e?e[1]:null},Yt=t=>("string"==typeof t&&(t=parseInt(t,10)),t<1024?`${t} B`:t<1048576?`${(t/1024).toFixed(1)} KB`:t<1073741824?`${(t/1048576).toFixed(1)} MB`:`${(t/1073741824).toFixed(1)} GB`),Gt=(t,e=2)=>{try{const s=(new DOMParser).parseFromString(t,"text/xml");if(s.querySelector("parsererror"))return t;let a="";const o=t=>" ".repeat(t*e),r=(t,e)=>{if(t.nodeType===Node.ELEMENT_NODE){const s=t;if(a+=`${o(e)}<${s.tagName}`,s.hasAttributes()&&(a+=Array.from(s.attributes).map(t=>`\n${o(e+1)}${t.name}="${t.value}"`).join("")),!s.childNodes.length&&!s.textContent?.trim())return void(a+=" />\n");a+=">\n",Array.from(s.childNodes).forEach(t=>r(t,e+1)),a+=`${o(e)}</${s.tagName}>\n`}else t.nodeType===Node.TEXT_NODE&&t.textContent?.trim()&&(a+=`${o(e)}${t.textContent.trim()}\n`)};return r(s.documentElement,0),a.trim()}catch(s){return t}},Ht=t=>{for(const[e,s]of Object.entries(Ct.uploadImageMap))t=t.replace(new RegExp(e,"g"),s);return t},Ut=async t=>{if(!t||""===t)return"";const e=await r.parse(t);return e&&""!==e?e:""},Vt=async(t,e=!1)=>{t&&window.open(Rt(t,e),"_blank")},Wt=Object.freeze(Object.defineProperty({__proto__:null,download:Vt},Symbol.toStringTag,{value:"Module"})),Kt=t=>u({method:"get",url:"/report",params:t}),Xt=t=>u.post("/report",t),Zt=t=>u.put("/report",t),Jt=t=>u({method:"get",url:"/operate-log/list",params:t}),Qt=t=>u.get(`/post/score/list?postId=${t}`),te=t=>u.get(`/post/score/summary?postId=${t}`),ee=t=>u.post("/post/score",t),se=t=>u.post("/post/score/like",{id:t}),ae=t=>u.post("/post/score/bad",{id:t}),oe=async t=>{const e=await u.get("/admin/panel");if(200==e.data.code){const s=e.data.data;return{recentLoginStats:{chart:re(t("d.zui-jin-deng-lu-datarecentloginstatscount",[s.recentLoginStats.count]),s.recentLoginStats.list),count:s.recentLoginStats.count},recentRegisterStats:{chart:re(t("d.zui-jin-zhu-ce-datarecentregisterstatscount",[s.recentRegisterStats.count]),s.recentRegisterStats.list),count:s.recentRegisterStats.count},recentPostStats:{chart:re(t("d.zui-jin-fa-bu-de-tie-zi-datarecentpoststatscount",[s.recentPostStats.count]),s.recentPostStats.list),count:s.recentPostStats.count},recentResourcePostStats:{chart:re(t("d.zui-jin-fa-bu-de-zi-yuan-datarecentresourcepoststatscount",[s.recentResourcePostStats.count]),s.recentResourcePostStats.list),count:s.recentResourcePostStats.count},recentCommentStats:{chart:re(t("d.zui-jin-fa-bu-de-ping-lun-datarecentcommentstatscount",[s.recentCommentStats.count]),s.recentCommentStats.list),count:s.recentCommentStats.count},totalUsers:s.totalUsers,totalPosts:s.totalPosts,totalResourcePosts:s.totalResourcePosts,totalServerPosts:s.totalServerPosts,totalFiles:s.totalFiles,totalPendingFiles:s.totalPendingFiles,totalComments:s.totalComments}}return{}},re=(t,e)=>({title:{text:t},tooltip:{trigger:"axis"},xAxis:{type:"category",data:Object.keys(e)},yAxis:{type:"value"},series:[{data:Object.values(e),type:"line",smooth:!0,markPoint:{data:[{type:"min"},{type:"max"}]}}]});export{St as $,st as A,at as B,et as C,bt as D,mt as E,jt as F,tt as G,Q as H,V as I,N as J,_ as K,Lt as L,ut as M,ct as N,It as O,T as P,Yt as Q,Wt as R,yt as S,Qt as T,Nt as U,te as V,ee as W,se as X,ae as Y,Ft as Z,At as _,$ as a,$t as a0,B as a1,q as a2,dt as a3,L as a4,oe as a5,ot as a6,Y as a7,rt as a8,nt as a9,lt as aA,K as aB,W as aC,X as aD,J as aE,k as aF,Vt as aG,pt as aa,it as ab,O as ac,R as ad,Kt as ae,Zt as af,ft as ag,ht as ah,gt as ai,G as aj,H as ak,U as al,h as am,g as an,m as ao,f as ap,Dt as aq,vt as ar,wt as as,Pt as at,xt as au,j as av,D as aw,x as ax,Gt as ay,Jt as az,Ht as b,b as c,Mt as d,v as e,_t as f,y as g,S as h,Bt as i,P as j,Rt as k,c as l,w as m,A as n,Et as o,F as p,Ot as q,Ut as r,Tt as s,I as t,M as u,E as v,Xt as w,z as x,C as y,Z as z};
