import{C as a,k as t,f as e,i,J as s,K as o}from"../admin/service-Dq4pkIEc.js";import{u as r}from"../user/userStore-8LCsejjm.js";import{u as n}from"./userResourceStore-CUCH5_iM.js";import{e as c}from"../post/service-HXTCd_Ip.js";import{u as d}from"../../lucide-vue-next-Cfi51zEF.js";const g=d(),p=n(),u=r(),m=async(t,s,o=!0,r)=>{o&&(p.pagination.page=1),p.loading=!0,p.searchText=s.trim(),p.isSearch=!0;const n={userId:u.userInfo.id,type:2,page:p.pagination.page,limit:p.pagination.limit};""!==p.searchText&&(n.key=p.searchText),r&&"0"!=r&&(n.fileTypes=r);try{const s=await a(n);if(200!==s.data.code)return g.error(t("t.sou-suo-shi-bai")+s.data.message),!1;p.posts=s.data.data.list.map(a=>{const s=c(a.content);return a.cover=s.length>0?s[0]:"",a.createdAt=e(a.createdAt,t),a.content=i(a.content),a}),p.pagination={page:s.data.data.page,limit:s.data.data.limit,total:s.data.data.total,count:s.data.data.count},p.loading=!1}catch(d){return g.error(t("t.sou-suo-shi-bai")+d),p.loading=!1,!1}},l=a=>{const t=p.packageList[p.currenPkgId];t?(s(t.id).then(t=>{200===t.data.code&&(h(a),g.success(a("t.shan-chu-cheng-gong")))}).catch(t=>{g.error(a("t.qing-qiu-shi-bai")+t.msg)}),p.isDeletePkg=!1):g.error(a("t.ban-ben-bu-cun-zai"))},h=a=>{o({id:p.currenPostId}).then(t=>{p.packageList=t.data.data.map(t=>(t.createdAt=e(t.createdAt,a),t))}).catch(a=>{})},f=s=>{u.isLogin&&(p.isSearch?m(s,p.searchText,!1):(p.loading=!0,a({userId:u.userInfo.id,type:2,page:p.pagination.page,limit:p.pagination.limit}).then(a=>{p.posts=a.data.data.list.map(a=>{const o=c(a.content);return a.cover=o.length>0?t(o[0]):"",a.createdAt=e(a.createdAt,s),a.content=i(a.content),a}),p.pagination={page:a.data.data.page,limit:a.data.data.limit,total:a.data.data.total,count:a.data.data.count},p.loading=!1}).catch(a=>{g.error(s("t.jia-zai-shi-bai")+a.msg)})))};export{h as a,l as d,f as g,m as s};
