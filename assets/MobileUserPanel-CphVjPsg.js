import{C as e,o as a,f as t,D as s,E as l,F as u,A as i,k as n,B as o}from"./store-module/admin/service-B8wAbs3A.js";import{u as r}from"./store-module/user/userStore-CYZokpSa.js";import{v as c}from"./verify-DJBR8yD7.js";import{_ as d}from"./Card.vue_vue_type_script_setup_true_lang-bjhPCac0.js";import{_ as v}from"./MobileUserHeader.vue_vue_type_script_setup_true_lang-CWP6wlQE.js";import{f}from"./store-module/post/service-BOUuDl8-.js";import{v as p,w as m,L as y,G as g,x as _,U as x,H as j,N as k,f as b,I as h,o as C,B as I,C as w,D as L,q as A,A as $,g as z,F as U}from"./lucide-vue-next-DYmFLWJU.js";import{d as q}from"./copy-C-LASiXE.js";import{a as S}from"./store-module/user/service-DQ6CfGWp.js";import{at as H,e as M,au as P,V as B,C as F}from"./vendor-lucide-DYSNolYz.js";import"./store-global/configStore-CQ7TO-i0.js";import"./store-module/post/postStore-7aBFqooK.js";import"./Avatar.vue_vue_type_script_setup_true_lang-Cb42g1o5.js";import"./ScRole.vue_vue_type_script_setup_true_lang-C07R-pjc.js";import"./ScTag.vue_vue_type_script_setup_true_lang-Bc1RbIhV.js";const N={class:"flex flex-col justify-center items-center"},R={class:"text-lg font-bold"},T={class:"flex flex-col justify-center items-center"},D={class:"text-lg font-bold"},E={key:0,class:"h-8 w-0.5 bg-gray/40"},G={key:1,class:"flex flex-col justify-center items-center"},V={class:"text-lg font-bold"},J=["innerHTML"],K={class:"w-full h-full flex flex-wrap justify-evenly"},O={class:"text-center text-error"},Q=p({__name:"MobileUserPanel",setup(p){const{t:Q}=m(),W=y(),X=g(),Y=r(),Z=_(q(Y.userInfo)),ee=x(()=>!W.query.userId),ae=_(!0),te=_({data:[],likeCount:"0",count:0}),se=_({data:[],likeCount:"0",count:0}),le=_({data:[],likeCount:"0",count:0}),ue=_({data:[],count:0}),ie=_({data:[],count:0}),ne=e=>{Y.isLogin&&ee&&X.push({name:e})},oe=()=>{i().then(e=>{const a=e.data.data;a.headImg=n(a.headImg),a.signature=f(a.signature),Z.value=a,ae.value=!1}).catch(e=>{Y.userInfo={},Y.token="",Y.isLogin=!1})},re=e=>{o(e).then(e=>{const a=e.data.data;a.headImg=n(a.headImg),a.signature=f(a.signature),Z.value=a,ae.value=!1}).catch(e=>{ae.value=!1})};return j(()=>{ae.value=!0,W.query.userId?re(Number(W.query.userId)):(oe(),Y.isLogin&&e({userId:Y.userInfo.id,type:1}).then(e=>{te.value.likeCount=a(e.data.data.list.reduce((e,a)=>e+a.likeCount,0)),te.value.data=e.data.data.list.map(e=>{e.createdAt=t(e.createdAt,Q)}),te.value.count=e.data.data.count}).catch(e=>{}),Y.isLogin&&e({userId:Y.userInfo.id,type:2}).then(e=>{le.value.likeCount=a(e.data.data.list.reduce((e,a)=>e+a.likeCount,0)),le.value.data=e.data.data.list.map(e=>{e.createdAt=t(e.createdAt,Q)}),le.value.count=e.data.data.count}).catch(e=>{}),Y.isLogin&&s({types:"1,2,3,4,5,7",page:1,limit:10}).then(e=>{ue.value.count=e.data.data.total}),Y.isLogin&&l({creatorId:Y.userInfo.id,page:1,limit:10}).then(e=>{ie.value.data=e.data.data.list.map(e=>{e.createdAt=t(e.createdAt,Q)}),ie.value.count=e.data.data.count}),Y.isLogin&&u({uid:Y.userInfo.id,page:1,limit:10}).then(e=>{se.value.likeCount=a(e.data.data.list.reduce((e,a)=>e+a.likeCount,0)),se.value.data=e.data.data.list.map(e=>{e.createdAt=t(e.createdAt,Q)}),se.value.count=e.data.data.count}).catch(e=>{}),ae.value=!1)}),k(()=>W.query,e=>{ae.value=!0,e.userId?re(Number(e.userId)):oe()},{immediate:!0}),(e,a)=>ae.value?h("",!0):(C(),b(U,{key:0},[w(Y).isLogin||!ee.value?(C(),I(v,{key:0,onUpdateUserInfo:oe,userInfo:Z.value},null,8,["userInfo"])):h("",!0),w(Y).isLogin&&ee.value?(C(),I(d,{key:1,noCol:"",class:"w-full justify-evenly items-center"},{default:L(()=>[A("div",N,[A("p",R,$(te.value.count),1),A("p",null,$(e.$t("nav.tie-zi")),1)]),a[7]||(a[7]=A("div",{class:"h-8 w-0.5 bg-gray/40"},null,-1)),A("div",T,[A("p",D,$(le.value.count),1),A("p",null,$(e.$t("nav.zi-yuan")),1)]),w(c)([1,2,8,12])?(C(),b("div",E)):h("",!0),w(c)([1,2,8,12])?(C(),b("div",G,[A("p",V,$(ie.value.count),1),A("p",null,$(e.$t("nav.fu-wu-qi")),1)])):h("",!0)]),_:1})):h("",!0),!w(Y).isLogin&&Z.value&&!ee.value||w(Y).isLogin&&Z.value&&!ee.value?(C(),I(d,{key:2,class:"stats w-full",noCol:""},{default:L(()=>[A("div",{innerHTML:Z.value.signature||"<p>这个人很懒，什么都没有留下</p>",class:"tiptap w-full"},null,8,J)]),_:1})):h("",!0),w(Y).isLogin&&ee.value?(C(),I(d,{key:3,class:"stats w-full"},{default:L(()=>[A("div",K,[A("div",{class:"flex flex-col justify-center items-center flex-1",onClick:a[0]||(a[0]=e=>ne("mobileUserPost"))},[z(w(H),{class:"text-primary",size:26}),A("p",null,$(e.$t("nav.tie-zi")),1)]),A("div",{class:"flex flex-col justify-center items-center flex-1",onClick:a[1]||(a[1]=e=>ne("mobileUserResource"))},[z(w(M),{class:"text-primary",size:26}),A("p",null,$(e.$t("nav.zi-yuan")),1)]),A("div",{class:"flex flex-col justify-center items-center flex-1",onClick:a[2]||(a[2]=e=>ne("mobileUserFile"))},[z(w(P),{class:"text-primary",size:26}),A("p",null,$(e.$t("nav.wen-jian")),1)]),A("div",{class:"flex flex-col justify-center items-center flex-1",onClick:a[3]||(a[3]=e=>ne("mobileUserServer"))},[z(w(B),{class:"text-primary",size:26}),A("p",null,$(e.$t("nav.fu-wu-qi")),1)])])]),_:1})):h("",!0),w(Y).isLogin&&ee.value?(C(),I(d,{key:4,class:"w-full"},{default:L(()=>[A("div",{class:"flex justify-between px-2 py-1",onClick:a[4]||(a[4]=e=>ne("mobileUserEdit"))},[A("span",null,$(e.$t("nav.bian-ji-zi-liao")),1),z(w(F))]),a[8]||(a[8]=A("div",{class:"border-b border-gray/40"},null,-1)),A("div",{class:"flex justify-between px-2 py-1",onClick:a[5]||(a[5]=e=>ne("mobileAccountSecurity"))},[A("span",null,$(e.$t("d.zhang-hao-an-quan")),1),z(w(F))])]),_:1})):h("",!0),w(Y).isLogin&&ee.value?(C(),I(d,{key:5,noPg:"",class:"w-full justify-center mt-4 p-3",onClick:a[6]||(a[6]=()=>{w(S)(e.$t),w(X).push({name:"Home"})})},{default:L(()=>[A("p",O,$(e.$t("b.tui-chu-deng-lu")),1)]),_:1})):h("",!0)],64))}});export{Q as default};
