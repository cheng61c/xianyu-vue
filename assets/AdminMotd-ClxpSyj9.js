import{v as e,w as a,u as t,x as l,U as s,H as o,N as u,f as n,o as r,g as d,D as i,q as c,C as v,J as p,A as g,F as m,y as h,Y as x,Z as f,Q as _}from"./lucide-vue-next-DYmFLWJU.js";import{_ as b}from"./Card.vue_vue_type_script_setup_true_lang-bjhPCac0.js";import{_ as y}from"./ScInput.vue_vue_type_script_setup_true_lang-BGlwauwP.js";import{_ as j}from"./ScButton.vue_vue_type_script_setup_true_lang-BX58BrIO.js";import{av as k,f as S,aw as $,ax as w,ay as C}from"./store-module/admin/service-B8wAbs3A.js";import{_ as A}from"./ScSelector.vue_vue_type_script_setup_true_lang-5nAo2qJC.js";import{u as V}from"./useEditorShortcuts-DoEurPs9.js";import{$ as q,a1 as B,l as U}from"./vendor-lucide-DYSNolYz.js";import{_ as I}from"./index-Cb4mdASZ.js";import"./store-global/configStore-CQ7TO-i0.js";import"./store-module/user/userStore-CYZokpSa.js";import"./store-module/post/postStore-7aBFqooK.js";import"./zh-lang-UpYDLdiS.js";import"./en-lang-DIx6Q4dK.js";import"./store-global/deviceStore-KKN3G4DG.js";const H={class:"flex gap-2"},R={class:"flex gap-2 items-center"},T={class:"text-gray-content"},z={class:"flex justify-between items-center"},D={class:"flex gap-2 items-center"},E={class:"flex gap-4"},M={class:"flex"},N={class:"text-gray-content ml-1"},F={class:"flex"},J={class:"text-gray-content ml-1"},P={class:"relative flex border border-gray rounded-md overflow-y-hidden"},Q={class:"relative flex-1"},Y=["placeholder"],Z={class:"absolute right-4 bottom-2 text-xs text-gray-content select-none"},G=I(e({__name:"AdminMotd",setup(e){const{t:I}=a(),G=t(),K=l([]),L=l(""),O=l(4),W=l(null),X=l(null),ee=s(()=>L.value.split("\n")),ae=l(0),te=l([]),le=()=>{k().then(e=>{e.data&&200===e.data.code?(K.value=e.data.data.map(e=>(e.createdAt=S(e.createdAt,I),e.updatedAt=S(e.updatedAt,I),e.motd=decodeURIComponent(e.motd),e)),te.value=K.value.map((e,a)=>({label:e.createdAt,value:a})),ue()):K.value=[]}).catch(e=>{G.error(I("t.huo-qu-gong-gao-shi-bai")+e.msg)})},se=()=>{const e="object"==typeof ae.value?ae.value.value:ae.value,a={motd:L.value,id:K.value[e]?.id};$(a).then(()=>{G.success(I("t.geng-xin-cheng-gong")),le()}).catch(e=>{G.error(I("t.geng-xin-shi-bai")+e.msg)})},oe=()=>{w({motd:L.value}).then(()=>{G.success(I("t.tian-jia-cheng-gong")),le()}).catch(e=>{G.success(I("t.tian-jia-shi-bai")+e.msg)})},ue=async(e=!1)=>{const a="object"==typeof ae.value?ae.value.value:ae.value;L.value=K.value[a]?.motd||"",ae.value=te.value[a]||0;const t=document.querySelector("textarea"),l=t?.selectionStart||0,s=t?.selectionEnd||0,o=L.value;L.value=C(o,O.value),await _(),t&&(L.value.length>=s?t.setSelectionRange(l,s):t.setSelectionRange(L.value.length,L.value.length)),e&&se(),ne()},ne=()=>{W.value&&(W.value.style.height="auto",W.value.style.height=`${W.value.scrollHeight}px`),_(re)},re=()=>{W.value&&X.value&&(X.value.style.height=`${W.value.scrollHeight+6}px`)},de=()=>{W.value&&X.value&&(X.value.scrollTop=W.value.scrollTop)};return V(W,O,()=>{ue(!0)}),o(()=>{le()}),u(ae,e=>{null!=e&&ue(!1)}),u(W,()=>{ne()}),(e,a)=>(r(),n(m,null,[d(b,{class:"mb-4"},{default:i(()=>[c("div",H,[d(j,{onClick:le,icon:v(q),Border:""},{default:i(()=>[p(g(e.$t("b.shua-xin")),1)]),_:1},8,["icon"]),d(j,{onClick:se,icon:v(B),Border:""},{default:i(()=>[p(g(e.$t("b.bao-cun-xiu-gai")),1)]),_:1},8,["icon"]),d(j,{onClick:oe,icon:v(U),Border:""},{default:i(()=>[p(g(e.$t("b.bao-cun-wei-xin-gong-gao")),1)]),_:1},8,["icon"])]),c("div",R,[c("span",T,g(e.$t("d.dang-qian-gong-gao")),1),d(A,{modelValue:ae.value,"onUpdate:modelValue":a[0]||(a[0]=e=>ae.value=e),options:te.value,placeholder:e.$t("other.null"),class:"w-xs"},null,8,["modelValue","options","placeholder"])])]),_:1}),d(b,null,{default:i(()=>[c("div",z,[c("div",D,[c("span",null,g(e.$t("d.suo-jin-kuan-du"))+":",1),d(y,{modelValue:O.value,"onUpdate:modelValue":a[1]||(a[1]=e=>O.value=e),type:"number",placeholder:e.$t("d.suo-jin-kuan-du"),class:"h-10 mb-[2px]"},null,8,["modelValue","placeholder"]),d(j,{onClick:a[2]||(a[2]=e=>ue()),Border:"",noPd:"",class:"h-[42px] px-3"},{default:i(()=>[p(g(e.$t("b.que-ding")),1)]),_:1})]),c("div",E,[c("div",M,[a[4]||(a[4]=c("kbd",{class:"kbd"},"Tab",-1)),c("span",N,g(e.$t("b.suo-jin")),1)]),c("div",F,[a[5]||(a[5]=c("kbd",{class:"kbd"},"Ctrl",-1)),a[6]||(a[6]=p(" + ",-1)),a[7]||(a[7]=c("kbd",{class:"kbd"},"S",-1)),c("span",J,g(e.$t("d.ge-shi-hua-bing-bao-cun")),1)])])]),c("div",P,[c("div",{ref_key:"lineNumber",ref:X,class:"line-numbers select-none text-right px-2 py-2 text-xs text-gray-content dark:bg-gray/60 bg-gray/20 border-r border-gray overflow-y-hidden","aria-hidden":"true"},[(r(!0),n(m,null,h(ee.value,(e,a)=>(r(),n("span",{key:a,class:"block leading-[1.5rem] font-mono text-[16px]"},g(a+1),1))),128))],512),c("div",Q,[x(c("textarea",{"onUpdate:modelValue":a[3]||(a[3]=e=>L.value=e),ref_key:"textarea",ref:W,class:"code-input w-full px-4 py-2 text-[16px] leading-[1.5rem] resize-none overflow-auto focus:outline-none overflow-y-hidden",placeholder:e.$t("d.shi-mo-ye-mei-you"),maxlength:8e3,onInput:ne,onScroll:de,rows:"1"},null,40,Y),[[f,L.value]]),c("div",Z,g(L.value.length)+" / 8000 ",1)])])]),_:1})],64))}}),[["__scopeId","data-v-586d54f5"]]);export{G as default};
