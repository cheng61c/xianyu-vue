import{v as e,w as a,u as l,x as t,U as o,H as s,N as u,f as n,o as r,g as i,D as d,q as c,C as v,J as p,A as m,F as g,y as f,Y as h,Z as _,Q as x}from"./lucide-vue-next-Cfi51zEF.js";import{_ as y}from"./Card.vue_vue_type_script_setup_true_lang-CKUt07f3.js";import{_ as b}from"./ScInput.vue_vue_type_script_setup_true_lang-mHghoQCQ.js";import{_ as j}from"./ScButton.vue_vue_type_script_setup_true_lang-Ef9ZHzzG.js";import{av as S,f as $,aw as k,ax as w,ay as A}from"./store-module/admin/service-Dq4pkIEc.js";import{_ as C}from"./ScSelector.vue_vue_type_script_setup_true_lang-DdvKffTA.js";import{u as V}from"./useEditorShortcuts-Bl9PE0av.js";import{$ as q,a1 as B,l as U}from"./vendor-lucide-BLqUBl1f.js";import{_ as I}from"./index-CAt4bNNt.js";import"./store-global/configStore-BTeIPwoA.js";import"./store-module/user/userStore-8LCsejjm.js";import"./store-module/post/postStore-D6edmGvH.js";import"./zh-lang-UpYDLdiS.js";import"./en-lang-DIx6Q4dK.js";import"./store-global/deviceStore-KmV5dTi1.js";const H={class:"flex gap-2"},M={class:"flex gap-2 items-center"},R={class:"text-gray-content"},z={class:"flex justify-between items-center"},D={class:"flex gap-2 items-center"},E={class:"relative flex border border-gray rounded-md overflow-y-hidden"},N={class:"relative flex-1"},T=["placeholder"],F={class:"absolute right-4 bottom-2 text-xs text-gray-content select-none"},J=I(e({__name:"MobileAdminMotd",setup(e){const{t:I}=a(),J=l(),Q=t([]),Y=t(""),Z=t(2),G=t(null),K=t(null),L=o(()=>Y.value.split("\n")),O=t(0),P=t([]),W=()=>{S().then(e=>{e.data&&200===e.data.code?(Q.value=e.data.data.map(e=>(e.createdAt=$(e.createdAt,I),e.updatedAt=$(e.updatedAt,I),e.motd=decodeURIComponent(e.motd),e)),P.value=Q.value.map((e,a)=>({label:e.createdAt,value:a})),ae()):Q.value=[]}).catch(e=>{J.error(I("t.huo-qu-gong-gao-shi-bai")+e.msg)})},X=()=>{var e;const a="object"==typeof O.value?O.value.value:O.value,l={motd:Y.value,id:null==(e=Q.value[a])?void 0:e.id};k(l).then(()=>{J.success(I("t.geng-xin-cheng-gong")),W()}).catch(e=>{J.error(I("t.geng-xin-shi-bai")+e.msg)})},ee=()=>{w({motd:Y.value}).then(()=>{J.success(I("t.tian-jia-cheng-gong")),W()}).catch(e=>{J.success(I("t.tian-jia-shi-bai")+e.msg)})},ae=async(e=!1)=>{var a;const l="object"==typeof O.value?O.value.value:O.value;Y.value=(null==(a=Q.value[l])?void 0:a.motd)||"",O.value=P.value[l]||0;const t=document.querySelector("textarea"),o=(null==t?void 0:t.selectionStart)||0,s=(null==t?void 0:t.selectionEnd)||0,u=Y.value;Y.value=A(u,Z.value),await x(),t&&(Y.value.length>=s?t.setSelectionRange(o,s):t.setSelectionRange(Y.value.length,Y.value.length)),e&&X(),le()},le=()=>{G.value&&(G.value.style.height="auto",G.value.style.height=`${G.value.scrollHeight}px`),x(te)},te=()=>{G.value&&K.value&&(K.value.style.height=`${G.value.scrollHeight+6}px`)},oe=()=>{G.value&&K.value&&(K.value.scrollTop=G.value.scrollTop)};return V(G,Z,()=>{ae(!0)}),s(()=>{W()}),u(O,e=>{null!=e&&ae(!1)}),u(G,()=>{le()}),(e,a)=>(r(),n(g,null,[i(y,{class:"mb-4"},{default:d(()=>[c("div",H,[i(j,{onClick:W,icon:v(q),Border:""},{default:d(()=>[p(m(e.$t("b.shua-xin")),1)]),_:1},8,["icon"]),i(j,{onClick:X,icon:v(B),Border:""},{default:d(()=>[p(m(e.$t("b.bao-cun-xiu-gai")),1)]),_:1},8,["icon"]),i(j,{onClick:ee,icon:v(U),Border:""},{default:d(()=>[p(m(e.$t("b.bao-cun-wei-xin-gong-gao")),1)]),_:1},8,["icon"])]),c("div",M,[c("span",R,m(e.$t("d.dang-qian-gong-gao")),1),i(C,{modelValue:O.value,"onUpdate:modelValue":a[0]||(a[0]=e=>O.value=e),options:P.value,placeholder:e.$t("other.null"),class:"flex-1"},null,8,["modelValue","options","placeholder"])])]),_:1}),i(y,null,{default:d(()=>[c("div",z,[c("div",D,[c("span",null,m(e.$t("d.suo-jin-kuan-du"))+":",1),i(b,{modelValue:Z.value,"onUpdate:modelValue":a[1]||(a[1]=e=>Z.value=e),type:"number",placeholder:e.$t("d.suo-jin-kuan-du"),class:"flex-1"},null,8,["modelValue","placeholder"]),i(j,{onClick:a[2]||(a[2]=e=>ae()),Border:""},{default:d(()=>[p(m(e.$t("b.que-ding")),1)]),_:1})])]),c("div",E,[c("div",{ref_key:"lineNumber",ref:K,class:"line-numbers select-none text-right px-2 py-2 text-xs text-gray-content dark:bg-gray/60 bg-gray/20 border-r border-gray overflow-y-hidden","aria-hidden":"true"},[(r(!0),n(g,null,f(L.value,(e,a)=>(r(),n("span",{key:a,class:"block leading-[1.5rem] font-mono text-[16px]"},m(a+1),1))),128))],512),c("div",N,[h(c("textarea",{"onUpdate:modelValue":a[3]||(a[3]=e=>Y.value=e),ref_key:"textarea",ref:G,class:"code-input w-full px-4 py-2 text-[16px] leading-[1.5rem] resize-none overflow-auto focus:outline-none overflow-y-hidden",placeholder:e.$t("d.shi-mo-ye-mei-you"),maxlength:8e3,onInput:le,onScroll:oe,rows:"1"},null,40,T),[[_,Y.value]]),c("div",F,m(Y.value.length)+" / 8000 ",1)])])]),_:1})],64))}}),[["__scopeId","data-v-ef1180d1"]]);export{J as default};
