import{v as e,w as a,u as t,x as l,U as o,H as s,N as u,f as n,o as r,g as i,D as d,q as c,C as v,J as p,A as m,F as g,y as h,Y as f,Z as _,Q as x}from"./lucide-vue-next-DYmFLWJU.js";import{_ as y}from"./Card.vue_vue_type_script_setup_true_lang-bjhPCac0.js";import{_ as b}from"./ScInput.vue_vue_type_script_setup_true_lang-BGlwauwP.js";import{_ as j}from"./ScButton.vue_vue_type_script_setup_true_lang-BX58BrIO.js";import{av as S,f as $,aw as k,ax as w,ay as A}from"./store-module/admin/service-B8wAbs3A.js";import{_ as C}from"./ScSelector.vue_vue_type_script_setup_true_lang-5nAo2qJC.js";import{u as V}from"./useEditorShortcuts-DoEurPs9.js";import{$ as q,a1 as B,l as U}from"./vendor-lucide-DYSNolYz.js";import{_ as I}from"./index-Cb4mdASZ.js";import"./store-global/configStore-CQ7TO-i0.js";import"./store-module/user/userStore-CYZokpSa.js";import"./store-module/post/postStore-7aBFqooK.js";import"./zh-lang-UpYDLdiS.js";import"./en-lang-DIx6Q4dK.js";import"./store-global/deviceStore-KKN3G4DG.js";const H={class:"flex gap-2"},M={class:"flex gap-2 items-center"},R={class:"text-gray-content"},z={class:"flex justify-between items-center"},D={class:"flex gap-2 items-center"},E={class:"relative flex border border-gray rounded-md overflow-y-hidden"},N={class:"relative flex-1"},T=["placeholder"],F={class:"absolute right-4 bottom-2 text-xs text-gray-content select-none"},J=I(e({__name:"MobileAdminMotd",setup(e){const{t:I}=a(),J=t(),Q=l([]),Y=l(""),Z=l(2),G=l(null),K=l(null),L=o(()=>Y.value.split("\n")),O=l(0),P=l([]),W=()=>{S().then(e=>{e.data&&200===e.data.code?(Q.value=e.data.data.map(e=>(e.createdAt=$(e.createdAt,I),e.updatedAt=$(e.updatedAt,I),e.motd=decodeURIComponent(e.motd),e)),P.value=Q.value.map((e,a)=>({label:e.createdAt,value:a})),ae()):Q.value=[]}).catch(e=>{J.error(I("t.huo-qu-gong-gao-shi-bai")+e.msg)})},X=()=>{const e="object"==typeof O.value?O.value.value:O.value,a={motd:Y.value,id:Q.value[e]?.id};k(a).then(()=>{J.success(I("t.geng-xin-cheng-gong")),W()}).catch(e=>{J.error(I("t.geng-xin-shi-bai")+e.msg)})},ee=()=>{w({motd:Y.value}).then(()=>{J.success(I("t.tian-jia-cheng-gong")),W()}).catch(e=>{J.success(I("t.tian-jia-shi-bai")+e.msg)})},ae=async(e=!1)=>{const a="object"==typeof O.value?O.value.value:O.value;Y.value=Q.value[a]?.motd||"",O.value=P.value[a]||0;const t=document.querySelector("textarea"),l=t?.selectionStart||0,o=t?.selectionEnd||0,s=Y.value;Y.value=A(s,Z.value),await x(),t&&(Y.value.length>=o?t.setSelectionRange(l,o):t.setSelectionRange(Y.value.length,Y.value.length)),e&&X(),te()},te=()=>{G.value&&(G.value.style.height="auto",G.value.style.height=`${G.value.scrollHeight}px`),x(le)},le=()=>{G.value&&K.value&&(K.value.style.height=`${G.value.scrollHeight+6}px`)},oe=()=>{G.value&&K.value&&(K.value.scrollTop=G.value.scrollTop)};return V(G,Z,()=>{ae(!0)}),s(()=>{W()}),u(O,e=>{null!=e&&ae(!1)}),u(G,()=>{te()}),(e,a)=>(r(),n(g,null,[i(y,{class:"mb-4"},{default:d(()=>[c("div",H,[i(j,{onClick:W,icon:v(q),Border:""},{default:d(()=>[p(m(e.$t("b.shua-xin")),1)]),_:1},8,["icon"]),i(j,{onClick:X,icon:v(B),Border:""},{default:d(()=>[p(m(e.$t("b.bao-cun-xiu-gai")),1)]),_:1},8,["icon"]),i(j,{onClick:ee,icon:v(U),Border:""},{default:d(()=>[p(m(e.$t("b.bao-cun-wei-xin-gong-gao")),1)]),_:1},8,["icon"])]),c("div",M,[c("span",R,m(e.$t("d.dang-qian-gong-gao")),1),i(C,{modelValue:O.value,"onUpdate:modelValue":a[0]||(a[0]=e=>O.value=e),options:P.value,placeholder:e.$t("other.null"),class:"flex-1"},null,8,["modelValue","options","placeholder"])])]),_:1}),i(y,null,{default:d(()=>[c("div",z,[c("div",D,[c("span",null,m(e.$t("d.suo-jin-kuan-du"))+":",1),i(b,{modelValue:Z.value,"onUpdate:modelValue":a[1]||(a[1]=e=>Z.value=e),type:"number",placeholder:e.$t("d.suo-jin-kuan-du"),class:"flex-1"},null,8,["modelValue","placeholder"]),i(j,{onClick:a[2]||(a[2]=e=>ae()),Border:""},{default:d(()=>[p(m(e.$t("b.que-ding")),1)]),_:1})])]),c("div",E,[c("div",{ref_key:"lineNumber",ref:K,class:"line-numbers select-none text-right px-2 py-2 text-xs text-gray-content dark:bg-gray/60 bg-gray/20 border-r border-gray overflow-y-hidden","aria-hidden":"true"},[(r(!0),n(g,null,h(L.value,(e,a)=>(r(),n("span",{key:a,class:"block leading-[1.5rem] font-mono text-[16px]"},m(a+1),1))),128))],512),c("div",N,[f(c("textarea",{"onUpdate:modelValue":a[3]||(a[3]=e=>Y.value=e),ref_key:"textarea",ref:G,class:"code-input w-full px-4 py-2 text-[16px] leading-[1.5rem] resize-none overflow-auto focus:outline-none overflow-y-hidden",placeholder:e.$t("d.shi-mo-ye-mei-you"),maxlength:8e3,onInput:te,onScroll:oe,rows:"1"},null,40,T),[[_,Y.value]]),c("div",F,m(Y.value.length)+" / 8000 ",1)])])]),_:1})],64))}}),[["__scopeId","data-v-2b2990ec"]]);export{J as default};
