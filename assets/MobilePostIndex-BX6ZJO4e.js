import{_ as e}from"./Avatar.vue_vue_type_script_setup_true_lang-Cq1EuCfW.js";import{_ as t}from"./Card.vue_vue_type_script_setup_true_lang-CKUt07f3.js";import{_ as s}from"./ScButton.vue_vue_type_script_setup_true_lang-Ef9ZHzzG.js";import{i as a,n as o,P as l,f as n}from"./store-module/admin/service-Dq4pkIEc.js";import{v as i,G as u,w as r,B as p,o as c,D as d,q as m,g as v,I as f,A as g,f as _,C as y,F as h,y as x,J as b,E as k,x as w,N as j,P,Q as C,u as S,H as T,R as B,L as I,T as $,U as z,z as V,K as N}from"./lucide-vue-next-Cfi51zEF.js";import{_ as U}from"./ScTag.vue_vue_type_script_setup_true_lang-DsxShMn2.js";import{_ as A,a as R}from"./ScButtonSelector.vue_vue_type_script_setup_true_lang-BvKCg36H.js";import{u as L,i as q}from"./fileType-DRkYn7FT.js";import{_ as D}from"./ScRole.vue_vue_type_script_setup_true_lang-Bz5l_0n_.js";import{S as M,b as H,c as E,d as F,E as J,P as Y,e as G,C as K,f as Q,g as O,h as W,X,i as Z,F as ee,A as te,j as se,k as ae,l as oe}from"./vendor-lucide-BLqUBl1f.js";import{_ as le}from"./ScDrawer.vue_vue_type_script_setup_true_lang-BAH82y4L.js";import{u as ne}from"./store-module/post/postStore-D6edmGvH.js";import{g as ie,a as ue,b as re,h as pe,c as ce,d as de,s as me}from"./store-module/post/service-HXTCd_Ip.js";import{_ as ve}from"./HomeNav.vue_vue_type_script_setup_true_lang-CzSU8YDk.js";import{_ as fe}from"./ScLogin.vue_vue_type_script_setup_true_lang-n2_F9gFT.js";import{u as ge}from"./store-global/configStore-BTeIPwoA.js";import{u as _e}from"./store-module/user/userStore-8LCsejjm.js";import{u as ye}from"./store-global/announcementStore-CRIAGzsc.js";import{_ as he}from"./ThemeButton.vue_vue_type_script_setup_true_lang-DKa9dFAs.js";import{a as xe}from"./store-module/user/service-BGP4hTQa.js";import{v as be}from"./verify-CgysHlmG.js";import{u as ke}from"./store-global/drawerStore-BV3ZUw2h.js";import{_ as we}from"./ScSelector.vue_vue_type_script_setup_true_lang-DdvKffTA.js";import{_ as je}from"./index-CAt4bNNt.js";import{_ as Pe}from"./ScInput.vue_vue_type_script_setup_true_lang-mHghoQCQ.js";import{_ as Ce}from"./Pagination.vue_vue_type_script_setup_true_lang-DhJQJgY1.js";import{_ as Se}from"./PopupBox.vue_vue_type_script_setup_true_lang-8C3JL_QJ.js";import"./store-global/deviceStore-KmV5dTi1.js";import"./ScModal.vue_vue_type_script_setup_true_lang-Go71FWDS.js";import"./store-global/themeStore-CaQtZyHC.js";import"./zh-lang-UpYDLdiS.js";import"./en-lang-DIx6Q4dK.js";const Te={class:"mr-auto flex items-center gap-2"},Be={class:"font-bold"},Ie={class:"text-sm text-gray-content"},$e={class:"text-gray-content"},ze={class:"font-bold"},Ve={key:0,class:"flex gap-2"},Ne={class:"flex justify-between mt-2"},Ue={class:"flex gap-2 items-center cursor-pointer"},Ae=i({__name:"MobilePostItem",props:{post:{}},setup(o){const l=u(),{t:n}=r(),i=o,w=L(n),j=()=>{l.push({name:"postDetails",params:{postId:i.post.id}})};return(l,n)=>(c(),p(t,null,{default:d(()=>[m("div",{class:"flex gap-2 justify-start items-center align-middle cursor-pointer",onClick:j},[v(e,{src:o.post.creator.headImg,alt:o.post.creator.nickname,size:34},null,8,["src","alt"]),m("div",null,[m("div",Te,[m("span",Be,g(o.post.creator.nickname),1),o.post.creator&&o.post.creator.roles?(c(),p(D,{key:0,user:o.post.creator,size:"sm"},null,8,["user"])):f("",!0)]),m("div",Ie,g(o.post.createdAt),1)])]),m("div",{class:"line-clamp-3 cursor-pointer",onClick:j},[m("div",$e,[m("div",ze,g(o.post.title),1),m("div",null,g(y(a)(o.post.content)),1)]),o.post.images?(c(),_("div",Ve,[(c(!0),_(h,null,x(o.post.images,e=>(c(),p(A,{key:e,src:e,alt:o.post.title,class:"w-28 h-28"},null,8,["src","alt"]))),128))])):f("",!0)]),m("div",Ne,[m("div",Ue,[v(U,{size:"sm",icon:y(M),status:"info",onClick:n[0]||(n[0]=e=>l.$router.push({params:{plateId:o.post.plate.id}}))},{default:d(()=>[b(g(o.post.plate.name),1)]),_:1},8,["icon"]),2==o.post.type?(c(),p(U,{key:0,size:"sm",icon:y(q)[o.post.fileType],status:"info"},{default:d(()=>[b(g(y(w)[o.post.fileType]),1)]),_:1},8,["icon"])):f("",!0)])]),m("div",{class:"flex gap-6 justify-between",onClick:j},[v(s,{noPadding:"",noBg:"",icon:y(H),class:k({"text-like":o.post.isLiked})},{default:d(()=>[b(g(o.post.likeCount),1)]),_:1},8,["icon","class"]),v(s,{noPadding:"",noBg:"",icon:y(E),class:k({"text-bad":o.post.isBaded})},null,8,["icon","class"]),v(s,{noPadding:"",noBg:"",icon:y(F)},{default:d(()=>[b(g(o.post.commentCount),1)]),_:1},8,["icon"]),v(s,{noPadding:"",noBg:"",icon:y(J)},{default:d(()=>[b(g(o.post.views),1)]),_:1},8,["icon"]),2==o.post.type?(c(),p(s,{key:0,noPadding:"",noBg:"",icon:"0"==o.post.postVersionCount?y(Y):y(G)},{default:d(()=>[b(g(o.post.postVersionCount),1)]),_:1},8,["icon"])):f("",!0)])]),_:1}))}}),Re=i({__name:"ScAccordionItem",props:{open:{type:Boolean},Border:{type:Boolean}},emits:["update:open"],setup(e,{emit:t}){const s=e,a=t,o=w(s.open),l=w(null);j(()=>s.open,async e=>{o.value=e,await C(),i(e)},{immediate:!0});const n=()=>a("update:open",!o.value),i=e=>{const t=l.value;if(t){if(t.style.overflow="hidden",e){t.style.height="0px";const e=t.scrollHeight+"px";requestAnimationFrame(()=>{t.style.transition="height 0.2s ease",t.style.height=e})}else t.style.height=t.scrollHeight+"px",requestAnimationFrame(()=>{t.style.transition="height 0.2s ease",t.style.height="0px"});t.addEventListener("transitionend",()=>{t.style.transition="",t.style.height=e?"auto":"0px",t.style.overflow=e?"visible":"hidden"},{once:!0})}};return(t,s)=>(c(),_("div",{class:k(["w-full py-1",{"border-b border-gray/80":e.Border}])},[m("button",{onClick:n,class:"w-full flex items-center justify-between px-2 py-2 text-left hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"},[P(t.$slots,"title"),v(y(K),{class:k([" transform transition-transform",o.value?"rotate-90":"rotate-0"])},null,8,["class"])]),m("div",{ref_key:"contentRef",ref:l,class:"px-2 overflow-hidden h-0"},[P(t.$slots,"content")],512)],2))}}),Le={class:"flex gap-4 items-center py-2"},qe={class:"text-md font-semibold text-active-content"},De={class:"text-active-content"},Me=i({__name:"CreatrPostJump",props:{title:{},prompt:{},btnText:{},postId:{}},setup:e=>(t,a)=>(c(),_("div",Le,[m("div",null,[m("h2",qe,g(e.title),1),m("p",De,g(e.prompt),1)]),v(s,{onClick:a[0]||(a[0]=e=>t.$emit("clickToResources")),class:"mt-2",Border:""},{default:d(()=>[b(g(e.btnText),1)]),_:1})]))}),He={class:"h-12 w-full flex justify-between items-center px-4 bg-background"},Ee={class:"bg-background w-64 h-full p-4"},Fe={class:"text-xl px-2"},Je={class:"flex flex-col"},Ye={class:"flex flex-col space-y-4 py-2 px-2"},Ge=["onClick"],Ke=["onClick"],Qe={class:"flex gap-4 items-center justify-between py-2"},Oe={class:"flex gap-4 items-center justify-between py-1"},We=["onClick"],Xe=["onClick"],Ze=je(i({__name:"MobileHomeNav",setup(e){const t=ne(),a=w(!1),o=w(""),l=w(!1),n=S(),i=ge(),u=_e(),p=ye(),x=ke(),{locale:k,t:P}=r(),C=ie(P),I=()=>{n.success({component:Me,listeners:{click:()=>{}}},{timeout:3e4,status:"success"})},$=()=>{a.value=!0},z=e=>{t.nav.name=e,o.value=e},V=e=>{t.postPage.page=e},N=()=>{u.userInfo={},u.isLogin=!1,u.token="",n.success(P("t.yong-hu-huan-cun-yi-qing-chu"))},U=()=>{p.popUps=[],p.banners=[],n.success(P("t.gong-gao-yi-du-zhuang-tai-yi-qing-chu"))},A=()=>{x.drawers=[],n.success("清空抽屉")};return j(()=>i.lang,()=>{k.value=i.lang.value},{immediate:!0}),T(()=>{ue(P)}),(e,n)=>(c(),_(h,null,[m("div",He,[v(s,{noPd:"",onClick:$,icon:y(Q),iconSize:20},null,8,["icon"]),v(ve,{menuItems:y(C),activeNavName:o.value,updateNav:z,updatePage:V},null,8,["menuItems","activeNavName"]),v(fe)]),v(le,{modelValue:a.value,"onUpdate:modelValue":n[2]||(n[2]=e=>a.value=e),position:"left"},B({_:2},[y(t).plate?{name:"default",fn:d(({close:a})=>[m("div",Ee,[m("h3",Fe,g(e.$t("b.cai-dan")),1),y(t).plate?(c(),_(h,{key:0},[v(Re,{open:l.value,"onUpdate:open":n[0]||(n[0]=e=>l.value=e),Border:""},{title:d(()=>[...n[3]||(n[3]=[b("测试工具箱",-1)])]),content:d(()=>[m("div",Je,[m("div",{class:"flex gap-4 items-center justify-between py-2",onClick:N},[m("div",null,g(e.$t("d.shan-chu-deng-lu-xin-xi"))+" ("+g(y(u).isLogin?"已登录":"未登录")+") ",1),m("button",null,[v(y(O))])]),m("div",{class:"flex gap-4 items-center justify-between py-2",onClick:U},[m("div",null,g(e.$t("d.shan-chu-gong-gao-yi-du-zhuang-tai"))+" ("+g(y(p).popUps.length)+") / ("+g(y(p).banners.length)+") ",1),m("button",null,[v(y(O))])]),m("div",{class:"flex gap-4 items-center justify-between py-2",onClick:A},[m("div",null,"清空抽屉 ("+g(y(x).drawers.length)+")",1),m("button",null,[v(y(O))])]),m("div",{class:"flex gap-4 items-center justify-between py-2",onClick:I},[n[4]||(n[4]=m("div",null,"弹窗",-1)),m("button",null,[v(y(O))])])])]),_:1},8,["open"]),m("div",Ye,[y(u).isLogin?(c(),_("div",{key:0,class:"flex items-center justify-between py-2",onClick:t=>(a(),e.$router.push({name:"message"}))},[m("div",null,g(e.$t("b.xiao-xi")),1),v(y(K))],8,Ge)):f("",!0),m("div",{class:"flex items-center justify-between py-2",onClick:t=>(a(),e.$router.push({name:"mingrentang"}))},[m("div",null,g(e.$t("b.ming-ren-tang")),1),v(y(K))],8,Ke),m("div",Qe,[m("div",null,g(e.$t("d.zhou-ye-qie-huan")),1),v(he)]),m("div",Oe,[m("div",null,g(e.$t("d.yu-yan-qie-huan")),1),v(we,{options:y(i).langs,modelValue:y(i).lang,"onUpdate:modelValue":n[1]||(n[1]=e=>y(i).lang=e),class:"w-32"},null,8,["options","modelValue"])]),y(u).isLogin&&y(be)([1,2,3,4,5,6,7,9,10])?(c(),_("div",{key:1,class:"flex items-center justify-between py-2",onClick:t=>(a(),e.$router.push({name:"mobileAdmin"}))},[m("div",null,g(e.$t("b.hou-tai-guan-li")),1),v(y(K))],8,We)):f("",!0),y(u).isLogin?(c(),_("div",{key:2,class:"flex gap-4 items-center justify-between py-2 text-error",onClick:t=>(a(),y(xe)(e.$t))},[m("span",null,g(e.$t("b.tui-chu-deng-lu")),1),v(s,{icon:y(W),iconSize:22,noPd:"",class:"text-error"},null,8,["icon"])],8,Xe)):f("",!0)])],64)):f("",!0)])]),key:"0"}:void 0]),1032,["modelValue"])],64))}}),[["__scopeId","data-v-b863c13a"]]),et={class:"flex min-w-full min-h-10 overflow-x-auto overflow-y-hidden no-scrollbar"},tt=je(i({__name:"MobilePlate",setup(e){const{t:t}=r(),a=I(),o=u(),l=ne(),n=w(0);return T(async()=>{l.currentPlate.currentRouteName=a.name||"",n.value=a.params.plateId?+a.params.plateId:0,ue(t),re(n.value,a,t)}),j(()=>a.path,()=>{l.currentPlate.currentRouteName!==a.name?n.value=0:n.value=a.params.plateId?+a.params.plateId:0,l.currentPlate.currentRouteName=a.name||"",ue(t),re(n.value,a,t)},{immediate:!0}),(e,t)=>(c(),_("div",et,[v(s,{onClick:t[0]||(t[0]=e=>y(pe)(0,y(a),y(o))),activation:0==n.value},{default:d(()=>[b(g(e.$t("b.quan-bu-ban-kuai")),1)]),_:1},8,["activation"]),(c(!0),_(h,null,x(y(l).plate[y(l).currentPlate.currentRouteName],e=>(c(),p(s,{key:e.id,onClick:t=>y(pe)(e.id,y(a),y(o)),activation:n.value==e.id||y(l).currentPlate.currentRouteName==e.name},{default:d(()=>[b(g(e.name),1)]),_:2},1032,["onClick","activation"]))),128))]))}}),[["__scopeId","data-v-8f09ba2f"]]),st={class:"absolute top-0 z-1 bg-white w-full"},at={key:0,class:"flex justify-center w-full bg-warning/30"},ot={class:"flex flex-col px-4 pt-2"},lt={class:"space-y-4 pb-4"},nt={class:"flex gap-2"},it={key:0,class:"space-y-2 pb-2"},ut={class:"flex flex-col"},rt=["onClick"],pt={class:"space-y-4"},ct=i({__name:"MobilePostIndex",setup(e){const a=$("refreshScroll",w(0)),i=$("containerRef",w(null)),k=ne(),{t:P}=r(),C=I(),S=w(C.params.plateId),B=ce(P),U=w(!1),A=ye(),L=de(P),q=z(()=>Math.ceil(k.postPage.total/k.postPage.limit)),D=w(null),M=u(),H=w(null),E=w(null),F=w(null),J=w(!1),Y=w(0),G=w(0),K=w(0),Q=w([]),O=w(!1),W=z(()=>({bottom:`${k.buttonBottom}px`,touchAction:"none"})),le=()=>{i&&i.value&&(i.value.scrollTo({top:0,behavior:"smooth"}),N.to(F.value,{keyframes:[{scale:1,right:"4rem",width:"100%",duration:.3},{scale:1,right:"4rem",width:"100%",duration:1.5},{scale:1,right:"1rem",width:"5%",duration:.3}]}))},ie=()=>{U.value=!1,D.value&&M.push({name:"postDetails",params:{postId:D.value.id}})},ue=e=>{J.value?e.preventDefault():M.push({name:"publishPost"})},pe=e=>{J.value=!0,Y.value=e.touches[0].clientY,G.value=k.buttonBottom,K.value=e.timeStamp},ve=e=>{if(!J.value||!H.value)return;e.preventDefault();const t=e.touches[0].clientY,s=Y.value-t;k.buttonBottom=G.value+s;const a=window.innerHeight-H.value.offsetHeight-20;k.buttonBottom=Math.max(20,Math.min(k.buttonBottom,a))},fe=()=>{J.value=!1},ge=async e=>{k.postPage.page=e,le(),await re(+S.value,C,P)};return j(()=>C.params,e=>{e.plateId&&(S.value=e.plateId,k.postPage.page=1,k.postPage.limit=10,re(+e.plateId,C,P))},{immediate:!0}),j(()=>k.fileType,()=>{me(k.searchText,!0,String(k.fileType),C,P)}),j(()=>k.orderType,()=>{me(k.searchText,!0,String(k.fileType),C,P)}),j(a,()=>{a.value>.2?N.to(E.value,{scale:1,bottom:"4rem",duration:.3}):N.to(E.value,{scale:0,bottom:"0",duration:.3})}),T(()=>{k.currentPlate.currentRouteName=C.name||"",k.searchText="",o({top:2}).then(e=>{D.value=(e=>{const t=new Set(A.popUps);return e.find(e=>!t.has(e.id))??null})(e.data.data.list),D.value&&(U.value=!0)}),l().then(e=>{200==e.data.code&&(Q.value=e.data.data.list.map(e=>(e.createdAt=n(e.createdAt,P),e)))})}),(e,a)=>{var o;return c(),_(h,null,[m("div",st,[v(Ze)]),a[7]||(a[7]=m("div",{class:"h-12"},null,-1)),U.value?(c(),_("div",at,[m("span",{onClick:ie},g(null==(o=D.value)?void 0:o.title),1),v(s,{class:"ml-4",icon:y(X),onClick:a[0]||(a[0]=e=>{var t,s;return(s=null==(t=D.value)?void 0:t.id)&&(A.popUps.push(s),A.popUps=Array.from(new Set(A.popUps))),void(U.value=!1)}),noPd:"",noBg:""},null,8,["icon"])])):f("",!0),m("div",ot,[m("div",lt,[v(tt),m("div",nt,[v(Pe,{modelValue:y(k).searchText,"onUpdate:modelValue":a[1]||(a[1]=e=>y(k).searchText=e),class:"flex-1",placeholder:e.$t("t.sou-suo-tie-zi-biao-ti")},null,8,["modelValue","placeholder"]),v(s,{icon:y(Z),noPd:"",onClick:a[2]||(a[2]=e=>{return t=y(k).searchText,s=!0,a=String(y(k).fileType),k.searchText=t,k.isSearch=!0,k.postPage.page=1,k.postPage.total=0,void me(t,s,a,C,P);var t,s,a})},{default:d(()=>[b(g(e.$t("b.sou-suo")),1)]),_:1},8,["icon"]),"modList"==y(C).name?(c(),p(Se,{key:0,ref:"popupBox",position:"bottom-left",icon:y(ee),className:"mt-1 py-1.5 px-1",noPd:""},{default:d(({close:e})=>[v(t,{noPg:"",class:"p-2 w-22 items-center"},{default:d(()=>[v(R,{col:"",options:y(B),modelValue:y(k).fileType,"onUpdate:modelValue":a[3]||(a[3]=e=>y(k).fileType=e),onClick:t=>e()},null,8,["options","modelValue","onClick"])]),_:2},1024)]),_:1},8,["icon"])):f("",!0),v(Se,{ref:"popupBox",position:"bottom-left",icon:y(te),className:"mt-1 py-1.5 px-1",noPd:""},{default:d(({close:e})=>[v(t,{noPg:"",class:"p-2 w-22 items-center"},{default:d(()=>[v(R,{col:"",options:y(L),modelValue:y(k).orderType,"onUpdate:modelValue":a[4]||(a[4]=e=>y(k).orderType=e),onClick:t=>e()},null,8,["options","modelValue","onClick"])]),_:2},1024)]),_:1},8,["icon"])])]),Q.value.length?(c(),_("div",it,[v(Re,{open:O.value,"onUpdate:open":a[6]||(a[6]=e=>O.value=e),Border:!1},{title:d(()=>[m("span",{class:"flex gap-2",onClick:a[5]||(a[5]=t=>e.$router.push({name:"postDetails",params:{postId:Q.value[0].id}}))},[v(y(se)),b(" "+g(Q.value[0].title),1)])]),content:d(()=>[m("div",ut,[(c(!0),_(h,null,x(Q.value.slice(1),t=>(c(),_("div",{key:t.id,class:"flex gap-2",onClick:s=>e.$router.push({name:"postDetails",params:{postId:t.id}})},[v(y(se)),m("span",null,g(t.title),1)],8,rt))),128))])]),_:1},8,["open"])])):f("",!0),m("div",pt,[y(k).post.length?(c(!0),_(h,{key:0},x(y(k).post,e=>(c(),p(Ae,{key:e.id,post:e},null,8,["post"]))),128)):f("",!0)])]),m("div",{ref_key:"draggableButton",ref:H,onTouchstartPassive:pe,onTouchmove:ve,onTouchend:fe,class:"absolute right-6 flex items-center justify-center z-3",style:V(W.value)},[m("button",{ref_key:"toTopButton",ref:E,class:"absolute scale-10 bg-active w-12 h-12 text-active-content rounded-full flex items-center justify-center shadow-md",onClick:le},[v(y(ae),{size:24})],512),m("button",{class:"relative bg-active z-3 w-12 h-12 text-active-content rounded-full flex items-center justify-center shadow-md",onClick:ue},[v(y(oe),{size:24})]),m("button",{ref_key:"leftPage",ref:F,class:"absolute z-2 scale-10 bg-active h-8 text-active-content overflow-hidden rounded-[2rem] flex items-center justify-center shadow-md"},g(y(k).postPage.page)+" / "+g(q.value),513)],36),v(Ce,{"current-page":y(k).postPage.page,"total-items":y(k).postPage.total,"page-size":y(k).postPage.limit,onPageChange:ge},null,8,["current-page","total-items","page-size"]),a[8]||(a[8]=m("div",{class:"w-full min-h-4"},null,-1))],64)}}});export{ct as default};
