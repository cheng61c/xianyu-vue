import{_ as e}from"./ScSelector.vue_vue_type_script_setup_true_lang-DdvKffTA.js";import{_ as a}from"./Card.vue_vue_type_script_setup_true_lang-CKUt07f3.js";import{_ as l}from"./ScInput.vue_vue_type_script_setup_true_lang-mHghoQCQ.js";import{_ as u}from"./ScButton.vue_vue_type_script_setup_true_lang-Ef9ZHzzG.js";import{_ as t}from"./EmptyState.vue_vue_type_script_setup_true_lang-Bg-k0MPd.js";import{a6 as o,f as s,a7 as i,a8 as n,a9 as r,aa as d,ab as c,A as v}from"./store-module/admin/service-Dq4pkIEc.js";import{u as m}from"./store-module/user/userStore-8LCsejjm.js";import{_ as p}from"./Pagination.vue_vue_type_script_setup_true_lang-DhJQJgY1.js";import{_ as g}from"./ScTag.vue_vue_type_script_setup_true_lang-DsxShMn2.js";import{_ as h}from"./ScModal.vue_vue_type_script_setup_true_lang-Go71FWDS.js";import{v as f}from"./verify-CgysHlmG.js";import{v as x,w as b,u as _,G as y,x as k,H as $,f as j,o as V,g as z,B as C,D as w,q,J as B,A as U,F as I,y as S,I as T,C as L}from"./lucide-vue-next-Cfi51zEF.js";import{$ as A,a0 as D,_ as P}from"./vendor-lucide-BLqUBl1f.js";import"./store-global/configStore-BTeIPwoA.js";import"./store-module/post/postStore-D6edmGvH.js";import"./PopupBox.vue_vue_type_script_setup_true_lang-8C3JL_QJ.js";const E={class:"flex gap-4"},F={class:"flex gap-4"},G={class:"flex items-center gap-2 w-full"},H={class:"flex items-center gap-2 w-full"},J={class:"overflow-x-auto"},M={class:"table"},N={class:"flex gap-2 flex-wrap max-w-xs"},O={class:"flex items-center gap-2 flex-wrap min-w-20"},K={class:"flex items-center gap-2 flex-wrap"},Q={class:"text-xl mb-4"},R={class:"flex gap-4 justify-end"},W={class:"text-xl mb-4"},X={class:"flex items-center gap-2"},Y={key:0,class:"flex items-center gap-2"},Z={class:"flex items-center gap-2"},ee={class:"text-sm text-warning"},ae={key:1,class:"flex items-center gap-2"},le={class:"flex gap-4 justify-end"},ue={class:"text-xl mb-4"},te={class:"text-warning"},oe={class:"flex items-center gap-2 flex-wrap border border-gray p-2 rounded-lg"},se={class:"flex items-center gap-2 flex-wrap border border-gray p-2 rounded-lg"},ie={key:0,class:"text-sm text-error"},ne={class:"flex gap-4 justify-end"},re={class:"text-xl mb-4"},de={class:"flex gap-2 flex-wrap items-center"},ce={class:"flex gap-4 justify-end"},ve=x({__name:"AdminAccount",setup(x){const{t:ve}=b(),me=_(),pe=m(),ge=y(),he=k(""),fe=k(0),xe=[{value:0,label:ve("b.quan-bu")},{value:1,label:ve("b.zheng-chang")},{value:2,label:ve("b.jin-yong")}],be=k(0),_e=[{value:0,label:ve("b.sou-suo-yong-hu-ming")},{value:1,label:ve("b.sou-suo-ni-cheng")},{value:2,label:ve("b.sou-suo-shang-ci-deng-lu-ip")},{value:3,label:ve("b.sou-suo-you-xiang")},{value:4,label:ve("b.sou-suo-id")},{value:5,label:ve("b.sou-suo-bei-zhu")}],ye=k(0),ke=k([{value:0,label:ve("b.quan-bu-jiao-se")}]),$e=k({page:1,total:0,limit:10}),je=k([]),Ve=k(!1),ze=k(-1),Ce=k(!1),we=k(!1),qe=k([]),Be=k(!1),Ue=k({id:0,nickname:"",email:"",remark:"",password:"",account:"",roles:[]}),Ie=e=>{$e.value.page=e,Te()},Se=()=>{$e.value.page=1,Te()},Te=()=>{const e={page:$e.value.page,limit:$e.value.limit};let a="object"==typeof ye.value?ye.value.value:ye.value,l="object"==typeof fe.value?fe.value.value:fe.value,u="object"==typeof be.value?be.value.value:be.value;0!==l&&(e.disabled=l),0!==a&&(e.roleId=a),he.value&&0==u&&(e.account=he.value),he.value&&1==u&&(e.nickname=he.value),he.value&&2==u&&(e.lastLoginIp=he.value),he.value&&3==u&&(e.email=he.value),he.value&&4==u&&(e.id=Number(he.value)),he.value&&5==u&&(e.remark=he.value),o(e).then(e=>{200===e.data.code&&(je.value=e.data.data.list.map(e=>({...e,regTime:s(e.regTime,ve),lastLoginTime:s(e.lastLoginTime,ve)})),$e.value.total=e.data.data.total,$e.value.page=e.data.data.page,$e.value.limit=e.data.data.limit)}).catch(e=>{})},Le=(e,a)=>{const l=je.value[e];if(!Ve.value)return ze.value=e,Ue.value.remark=l.remark||"",void(Ve.value=!0);n({userId:l.id,disabled:a}).then(async e=>{if(200===e.data.code){try{await r({id:l.id,remark:Ue.value.remark}),f([1,2])&&await d(l.id),me.success(ve("t.cao-zuo-cheng-gong"))}catch(a){}Te(),Ve.value=!1}}).catch(e=>{})},Ae=e=>{const a=je.value[e];if(!Ce.value)return ze.value=e,void(Ce.value=!0);const l={};if(""!==Ue.value.nickname.trim()&&(l.nickname=Ue.value.nickname),""!==Ue.value.email.trim()&&(l.email=Ue.value.email),""!==Ue.value.password.trim()&&(l.password=Ue.value.password),""!==Ue.value.account.trim()&&(l.account=Ue.value.account),l.id=a.id,1===Object.keys(l).length)return me.warning(ve("t.sha-ye-bu-shi-zou-le")),void(Ce.value=!1);r(l).then(e=>{200===e.data.code&&(Te(),Ce.value=!1,me.success(ve("t.geng-xin-yong-hu-xin-xi-cheng-gong")),a.id===pe.userInfo.id?Ee():d(a.id))}).catch(e=>{me.error(ve("t.geng-xin-yong-hu-xin-xi-shi-bai")+e.msg)})},De=e=>{const a=je.value[e];if(!we.value)return ze.value=e,Ue.value.id=a.id,Ue.value.roles=a.roles,void(we.value=!0);let l={id:a.id,roleIds:Ue.value.roles.map(e=>e.id)};c(l).then(e=>{200===e.data.code&&(Te(),we.value=!1)}).catch(e=>{me.error(ve("t.geng-xin-jiao-se-shi-bai")+e.msg)})},Pe=e=>{const a=je.value[e];if(!Be.value)return ze.value=e,void(Be.value=!0);d(a.id).then(()=>{me.success(ve("t.cao-zuo-cheng-gong")),Te(),Ee(),Ve.value=!1}).catch(e=>{me.error(ve("t.geng-xin-yong-hu-xin-xi-shi-bai")+e.msg)})},Ee=()=>{v().catch(e=>{pe.token="",pe.userInfo={},pe.isLogin=!1,ge.replace({path:"/"}),me.error(ve("t.huo-qu-yong-hu-xin-xi-shi-bai")+e.msg)})};return $(()=>{$e.value.page=1,$e.value.limit=10,Te(),i().then(e=>{200===e.data.code&&(qe.value=e.data.data,ke.value=[{value:0,label:ve("b.quan-bu-jiao-se")},...e.data.data.map(e=>({value:e.id,label:e.name}))])}).catch(e=>{})}),(o,s)=>(V(),j(I,null,[z(a,{class:"mb-4"},{default:w(()=>[q("div",E,[z(e,{modelValue:be.value,"onUpdate:modelValue":s[0]||(s[0]=e=>be.value=e),options:_e,placeholder:o.$t("b.sou-suo-yong-hu-ming"),class:"w-40"},null,8,["modelValue","placeholder"]),z(l,{modelValue:he.value,"onUpdate:modelValue":s[1]||(s[1]=e=>he.value=e),placeholder:o.$t("b.sou-suo"),class:"w-xs"},null,8,["modelValue","placeholder"]),z(u,{class:"px-4",Border:"",onClick:Se},{default:w(()=>[B(U(o.$t("b.sou-suo")),1)]),_:1}),z(u,{class:"px-4",Border:"",onClick:Te},{default:w(()=>[B(U(o.$t("b.shua-xin")),1)]),_:1})]),q("div",F,[q("label",G,[q("span",null,U(o.$t("b.zhuang-tai")),1),z(e,{modelValue:fe.value,"onUpdate:modelValue":s[2]||(s[2]=e=>fe.value=e),options:xe,placeholder:o.$t("b.quan-bu"),class:"flex-1"},null,8,["modelValue","placeholder"])]),q("label",H,[q("span",null,U(o.$t("b.jiao-se")),1),z(e,{modelValue:ye.value,"onUpdate:modelValue":s[3]||(s[3]=e=>ye.value=e),options:ke.value,placeholder:o.$t("b.quan-bu-jiao-se"),class:"flex-1"},null,8,["modelValue","options","placeholder"])])])]),_:1}),z(a,{class:"mb-4"},{default:w(()=>[q("div",J,[q("table",M,[q("thead",null,[q("tr",null,[s[22]||(s[22]=q("th",null,"ID",-1)),q("th",null,U(o.$t("f.ni-cheng")),1),q("th",null,U(o.$t("f.yong-hu-ming")),1),q("th",null,U(o.$t("f.you-xiang")),1),q("th",null,U(o.$t("f.zhu-ce-shi-jian")),1),q("th",null,U(o.$t("f.zui-hou-deng-lu-shi-jian")),1),q("th",null,U(o.$t("f.zui-hou-deng-lu-ip")),1),q("th",null,U(o.$t("f.zhuang-tai")),1),q("th",null,U(o.$t("f.cao-zuo")),1)])]),q("tbody",null,[(V(!0),j(I,null,S(je.value,(e,a)=>(V(),j("tr",{key:e.id},[q("th",null,U(e.id),1),q("td",null,[q("div",N,[B(U(e.nickname)+" ",1),(V(!0),j(I,null,S(e.roles,(e,a)=>(V(),C(g,{key:a,bgColor:e.color,size:"xs"},{default:w(()=>[B(U(e.name),1)]),_:2},1032,["bgColor"]))),128))])]),q("td",null,U(e.account),1),q("td",null,U(e.email),1),q("td",null,U(e.regTime),1),q("td",null,U(e.lastLoginTime),1),q("td",null,U(e.lastLoginIp),1),q("td",null,[q("div",O,[e.disabled?(V(),C(g,{key:0,size:"xs",status:"error"},{default:w(()=>[B(U(o.$t("b.feng-jin")),1)]),_:1})):(V(),C(g,{key:1,size:"xs",status:"success"},{default:w(()=>[B(U(o.$t("b.zheng-chang")),1)]),_:1}))])]),q("td",null,[q("div",K,[z(u,{onClick:e=>Le(a),class:"border border-error text-error"},{default:w(()=>[B(U(o.$t("b.feng-jin")),1)]),_:1},8,["onClick"]),z(u,{onClick:e=>Ae(a),Border:""},{default:w(()=>[B(U(o.$t("b.xiu-gai-xin-xi")),1)]),_:1},8,["onClick"]),L(f)([1,2])?(V(),C(u,{key:0,onClick:e=>De(a),Border:""},{default:w(()=>[B(U(o.$t("b.she-zhi-jiao-se")),1)]),_:1},8,["onClick"])):T("",!0),L(f)([1,2])?(V(),C(u,{key:1,onClick:e=>Pe(a),Border:""},{default:w(()=>[B(U(o.$t("b.qiang-zhi-xia-xian")),1)]),_:1},8,["onClick"])):T("",!0)])])]))),128))])])])]),_:1}),je.value.length?(V(),C(p,{key:0,"current-page":$e.value.page,"total-items":$e.value.total,"page-size":$e.value.limit,onPageChange:Ie},null,8,["current-page","total-items","page-size"])):(V(),C(t,{key:1,title:o.$t("d.zan-wu-shu-ju"),iconSize:"64",iconColor:"#ccc",icon:L(D),class:"mt-8",action:o.$t("b.dian-ji-shua-xin"),actionIcon:L(A),onActionClick:Ie},null,8,["title","icon","action","actionIcon"])),z(h,{modelValue:Ve.value,"onUpdate:modelValue":s[8]||(s[8]=e=>Ve.value=e)},{default:w(()=>[z(a,{class:"p-6 w-2xl"},{default:w(()=>[q("h3",Q,U(o.$t("f.feng-jin-zhang-hao")),1),q("div",null,U(o.$t("f.feng-jin-yuan-yin")),1),z(l,{modelValue:Ue.value.remark,"onUpdate:modelValue":s[4]||(s[4]=e=>Ue.value.remark=e),placeholder:o.$t("d.shi-mo-ye-mei-you"),multiline:"",rows:12,resizable:!1,class:"mb-4 h-[20rem]"},null,8,["modelValue","placeholder"]),q("div",R,[z(u,{class:"px-4 border border-error text-error",onClick:s[5]||(s[5]=e=>Le(ze.value,1))},{default:w(()=>[B(U(o.$t("b.feng-jin")),1)]),_:1}),z(u,{class:"px-4",onClick:s[6]||(s[6]=e=>Le(ze.value,0)),Border:""},{default:w(()=>[B(U(o.$t("d.che-xiao-feng-jin")),1)]),_:1}),z(u,{class:"px-4",onClick:s[7]||(s[7]=e=>Ve.value=!1),Border:""},{default:w(()=>[B(U(o.$t("b.qu-xiao")),1)]),_:1})])]),_:1})]),_:1},8,["modelValue"]),z(h,{modelValue:Ce.value,"onUpdate:modelValue":s[15]||(s[15]=e=>Ce.value=e)},{default:w(()=>[z(a,{class:"p-6 w-2xl"},{default:w(()=>[q("h3",W,U(o.$t("f.xiu-gai-yong-hu-xin-xi")),1),q("div",X,[q("span",null,U(o.$t("f.ni-cheng")),1),z(l,{modelValue:Ue.value.nickname,"onUpdate:modelValue":s[9]||(s[9]=e=>Ue.value.nickname=e),placeholder:o.$t("f.ni-cheng"),class:"m-2"},null,8,["modelValue","placeholder"])]),L(f)([1,2])?(V(),j("div",Y,[q("span",null,U(o.$t("f.you-xiang")),1),z(l,{modelValue:Ue.value.email,"onUpdate:modelValue":s[10]||(s[10]=e=>Ue.value.email=e),placeholder:o.$t("f.you-xiang"),class:"m-2"},null,8,["modelValue","placeholder"])])):T("",!0),q("div",Z,[q("span",null,U(o.$t("f.mi-ma")),1),z(l,{modelValue:Ue.value.password,"onUpdate:modelValue":s[11]||(s[11]=e=>Ue.value.password=e),placeholder:o.$t("f.mi-ma"),class:"m-2"},null,8,["modelValue","placeholder"]),z(L(P),{size:18,class:"text-warning"}),q("span",ee,U(o.$t("d.dui-zi-ji-xiu-gai-mi-ma-hui-qiang-zhi-xia-xian")),1)]),L(f)([1,2])?(V(),j("div",ae,[q("span",null,U(o.$t("f.yong-hu-ming")),1),z(l,{modelValue:Ue.value.account,"onUpdate:modelValue":s[12]||(s[12]=e=>Ue.value.account=e),placeholder:o.$t("f.yong-hu-ming"),class:"m-2"},null,8,["modelValue","placeholder"])])):T("",!0),q("div",le,[z(u,{class:"px-4",onClick:s[13]||(s[13]=e=>Ae(ze.value)),Border:""},{default:w(()=>[B(U(o.$t("b.ti-jiao-xiu-gai")),1)]),_:1}),z(u,{class:"px-4",onClick:s[14]||(s[14]=e=>Ce.value=!1),Border:""},{default:w(()=>[B(U(o.$t("b.qu-xiao")),1)]),_:1})])]),_:1})]),_:1},8,["modelValue"]),z(h,{modelValue:we.value,"onUpdate:modelValue":s[18]||(s[18]=e=>we.value=e)},{default:w(()=>[z(a,{class:"p-6 w-2xl"},{default:w(()=>[q("h3",ue,U(o.$t("d.xiu-gai-yong-hu-quan-xian")),1),q("div",te,U(o.$t("d.dian-ji-biao-qian-tian-jia-huo-yi-chu")),1),q("div",null,U(o.$t("d.jiao-se-chi")),1),q("div",oe,[(V(!0),j(I,null,S(qe.value,(e,a)=>(V(),C(g,{key:a,bgColor:e.color,size:"md",class:"cursor-pointer",onClick:e=>(e=>{const a=qe.value[e];Ue.value.roles.some(e=>e.id===a.id)||Ue.value.roles.push(a)})(a)},{default:w(()=>[B(U(e.name),1)]),_:2},1032,["bgColor","onClick"]))),128))]),q("div",null,U(o.$t("d.dang-qian-cun-zai")),1),q("div",se,[(V(!0),j(I,null,S(je.value[ze.value].roles,(e,a)=>(V(),C(g,{key:a,bgColor:e.color,size:"sm",class:"cursor-pointer",onClick:e=>(e=>{Ue.value.roles.splice(e,1)})(a)},{default:w(()=>[B(U(e.name),1)]),_:2},1032,["bgColor","onClick"]))),128)),je.value[ze.value].roles.length?T("",!0):(V(),j("span",ie,U(o.$t("other.null")),1))]),q("div",ne,[z(u,{class:"px-4",onClick:s[16]||(s[16]=e=>De(ze.value)),Border:""},{default:w(()=>[B(U(o.$t("b.ti-jiao-xiu-gai")),1)]),_:1}),z(u,{class:"px-4",onClick:s[17]||(s[17]=e=>we.value=!1),Border:""},{default:w(()=>[B(U(o.$t("b.qu-xiao")),1)]),_:1})])]),_:1})]),_:1},8,["modelValue"]),z(h,{modelValue:Be.value,"onUpdate:modelValue":s[21]||(s[21]=e=>Be.value=e)},{default:w(()=>[z(a,{class:"p-6 w-2xl"},{default:w(()=>[q("h3",re,U(o.$t("b.qiang-zhi-xia-xian")),1),q("div",de,[B(U(o.$t("d.mu-biao-zhang-hao"))+" ",1),q("span",null,U(je.value[ze.value].nickname),1),z(g,{size:"xs",status:"info"},{default:w(()=>[B(" uid: "+U(je.value[ze.value].id),1)]),_:1}),(V(!0),j(I,null,S(je.value[ze.value].roles,(e,a)=>(V(),C(g,{key:a,bgColor:e.color,size:"xs"},{default:w(()=>[B(U(e.name),1)]),_:2},1032,["bgColor"]))),128))]),q("div",null,U(o.$t("d.rang-gai-zhang-hao-suo-you-she-bei-shi-qu-deng-lu-zhuang-tai-ke-shi-yong-zhang-hao-mi-ma-zai-ci-deng-lu-ji-shi-mu-biao-shi-zi-ji-ye-bu-li-wai")),1),q("div",ce,[z(u,{class:"px-4",onClick:s[19]||(s[19]=e=>Pe(ze.value)),Border:""},{default:w(()=>[B(U(o.$t("b.que-ding")),1)]),_:1}),z(u,{class:"px-4",onClick:s[20]||(s[20]=e=>Be.value=!1),Border:""},{default:w(()=>[B(U(o.$t("b.qu-xiao")),1)]),_:1})])]),_:1})]),_:1},8,["modelValue"])],64))}});export{ve as default};
