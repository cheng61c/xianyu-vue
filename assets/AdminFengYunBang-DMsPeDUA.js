import{v as e,u as l,w as a,x as t,M as u,H as n,f as o,o as s,g as i,B as d,I as r,D as c,q as v,C as m,J as p,A as g,F as h,y as f,W as _,R as b}from"./lucide-vue-next-DYmFLWJU.js";import{_ as x}from"./Card.vue_vue_type_script_setup_true_lang-bjhPCac0.js";import{_ as j}from"./ScModal.vue_vue_type_script_setup_true_lang-BZwKgEH6.js";import{_ as y}from"./TipTap.vue_vue_type_script_setup_true_lang-BWFjBvwN.js";import{_ as $}from"./ScButton.vue_vue_type_script_setup_true_lang-BX58BrIO.js";import{_ as q}from"./ScInput.vue_vue_type_script_setup_true_lang-BGlwauwP.js";import{u as k}from"./store-module/fengyunbang/FengYunBangStore-bVl1B3_I.js";import{a as I,b as w,d as V}from"./store-module/fengyunbang/service-_DJH3FEf.js";import{S as C}from"./store-module/admin/service-B8wAbs3A.js";import{_ as B}from"./Avatar.vue_vue_type_script_setup_true_lang-Cb42g1o5.js";import{$ as S,l as U}from"./vendor-lucide-DYSNolYz.js";import"./store-module/post/postStore-7aBFqooK.js";import"./store-global/configStore-CQ7TO-i0.js";import"./store-module/user/userStore-CYZokpSa.js";const z={class:"flex gap-2"},D={class:"overflow-x-auto"},A={class:"table"},F={class:"flex items-center gap-2"},L={class:"text-xl"},T={class:"flex items-center gap-4"},E={class:"flex items-center gap-4"},M={class:"flex items-center gap-4"},O={class:"flex items-center gap-4"},Y={class:"mt-4 border border-gray/20 rounded-lg p-4"},H={class:"flex justify-end mt-1 gap-4"},J={class:"text-xl"},K={class:"flex items-center gap-4"},P={class:"font-bold"},R={class:"flex justify-end mt-1 gap-4"},W=e({__name:"AdminFengYunBang",setup(e){const W=l(),{t:G}=a(),N=k(),Q=t(!1),X=t(!1),Z=t(null),ee=t(!1),le=t({id:0,title:"",headImg:"",content:""}),ae=t(""),te=()=>{if(!Q.value)return Q.value=!0,void(le.value={id:0,title:"",headImg:"",content:""});""!==ae.value&&(le.value.headImg=`http://q1.qlogo.cn/g?b=qq&s=4&nk=${ae.value.trim()}`),w(le.value,G,()=>{Q.value=!1,le.value={title:"",headImg:"",content:""},ae.value=""})},ue=e=>{if(e)return le.value={id:e.id,title:e.title,headImg:e.headImg,content:e.content||""},void(X.value=!0);le.value.id&&V(le.value.id,G,()=>{le.value={id:0,title:"",headImg:"",content:""},ae.value="",X.value=!1})},ne=e=>{Q.value&&e.ctrlKey&&"s"===e.key.toLowerCase()&&(e.preventDefault(),w(le.value,G,()=>{Q.value=!1,le.value={title:"",headImg:"",content:""},ae.value=""}))},oe=e=>{e.preventDefault();const l=e.dataTransfer?.files;l&&l.length>0&&se({target:{files:l}})},se=async e=>{const l=e.target.files;if(l){ee.value=!0;try{const e=l[0],a=await C(e,6);le.value.headImg=a.data.data.url,ee.value=!1}catch(a){W.error(G("t.tu-pian-shang-chuan-shi-bai-filename",[l[0].name])),ee.value=!1}Z.value&&(Z.value.value="")}},ie=()=>{Z.value?.click()};return u(()=>{window.removeEventListener("keydown",ne)}),n(()=>{I(G),window.addEventListener("keydown",ne)}),(e,l)=>(s(),o(h,null,[i(x,{class:"mb-4"},{default:c(()=>[v("div",z,[i($,{onClick:m(I),icon:m(S),Border:""},{default:c(()=>[p(g(e.$t("b.shua-xin-lie-biao")),1)]),_:1},8,["onClick","icon"]),i($,{onClick:te,icon:m(U),Border:""},{default:c(()=>[p(g(e.$t("b.tian-jia-wan-jia")),1)]),_:1},8,["icon"])])]),_:1}),m(N).list.length?(s(),d(x,{key:0,class:"mb-4"},{default:c(()=>[v("div",D,[v("table",A,[v("thead",null,[v("tr",null,[l[11]||(l[11]=v("th",null,"ID",-1)),v("th",null,g(e.$t("b.ming-cheng")),1),v("th",null,g(e.$t("b.chuang-jian-shi-jian")),1),v("th",null,g(e.$t("b.geng-xin-shi-jian")),1),v("th",null,g(e.$t("b.cao-zuo")),1)])]),v("tbody",null,[(s(!0),o(h,null,f(m(N).list,l=>(s(),o("tr",{key:l.id},[v("th",null,g(l.id),1),v("td",null,g(l.title),1),v("td",null,g(l.createdAt),1),v("td",null,g(l.updatedAt),1),v("td",null,[v("div",F,[i($,{Border:"",onClick:e=>(e=>{le.value={id:e.id,title:e.title,headImg:e.headImg,content:e.content||""},e.userId&&(le.value.userId=e.userId),""!==ae.value&&(le.value.headImg=`http://q1.qlogo.cn/g?b=qq&s=4&nk=${ae.value.trim()}`),Q.value=!0})(l)},{default:c(()=>[p(g(e.$t("b.bian-ji")),1)]),_:1},8,["onClick"]),i($,{Border:"",onClick:e=>ue(l)},{default:c(()=>[p(g(e.$t("b.shan-chu")),1)]),_:1},8,["onClick"])])])]))),128))])])])]),_:1})):r("",!0),i(j,{modelValue:Q.value,"onUpdate:modelValue":l[7]||(l[7]=e=>Q.value=e),offOverflow:""},{default:c(()=>[i(x,{class:"max-h-[80vh] overflow-y-auto w-5xl"},{default:c(()=>{return[v("span",L,g(e.$t("b.tian-jia-wan-jia")),1),v("div",T,[v("span",null,g(e.$t("d.ming-cheng")),1),i(q,{modelValue:le.value.title,"onUpdate:modelValue":l[0]||(l[0]=e=>le.value.title=e),placeholder:e.$t("t.wan-jia-ming-cheng"),class:"m-2"},null,8,["modelValue","placeholder"])]),v("div",E,[v("span",null,g(e.$t("f.tou-xiang-lian-jie")),1),i(q,{modelValue:le.value.headImg,"onUpdate:modelValue":l[1]||(l[1]=e=>le.value.headImg=e),placeholder:e.$t("t.tou-xiang-lian-jie"),class:"m-2"},null,8,["modelValue","placeholder"]),i($,{Border:"",onDragover:l[2]||(l[2]=_(()=>{},["prevent"])),onDrop:_(oe,["prevent"]),onClick:ie},b({default:c(()=>[v("input",{type:"file",accept:"image/*",ref_key:"fileInput",ref:Z,class:"hidden",onChange:se},null,544),v("div",null,g(e.$t("f.jiang-tu-pian-tuo-dao-ci-chu-huo-dian-ji-shang-chuan")),1)]),_:2},[le.value.headImg?{name:"endIcon",fn:c(()=>[i(B,{src:le.value.headImg,alt:le.value.title},null,8,["src","alt"])]),key:"0"}:void 0]),1024),ee.value?(s(),d($,{key:0,noPd:""},{default:c(()=>[...l[12]||(l[12]=[v("span",{class:"loading loading-spinner"},null,-1)])]),_:1})):r("",!0)]),v("div",M,[v("span",null,g(e.$t("f.huo-zhe-shi-yong-qq-tou-xiang")),1),l[13]||(l[13]=v("span",null,"http://q1.qlogo.cn/g?b=qq&s=4&nk=",-1)),i(q,{modelValue:ae.value,"onUpdate:modelValue":l[3]||(l[3]=e=>ae.value=e),placeholder:e.$t("f.tian-ru-qq-hao-zuo-wei-tou-xiang"),class:"m-2"},null,8,["modelValue","placeholder"]),""!=ae.value?(s(),d(B,{key:0,src:(a=ae.value,`http://q1.qlogo.cn/g?b=qq&s=4&nk=${a.trim()}`),alt:le.value.title},null,8,["src","alt"])):r("",!0)]),v("div",O,[v("span",null,g(e.$t("f.she-qu-id")),1),i(q,{modelValue:le.value.userId,"onUpdate:modelValue":l[4]||(l[4]=e=>le.value.userId=e),placeholder:e.$t("t.zai-she-qu-zhong-you-zhang-hao-shi-tian-xie"),class:"m-2"},null,8,["modelValue","placeholder"])]),v("div",Y,[i(y,{modelValue:le.value.content,"onUpdate:modelValue":l[5]||(l[5]=e=>le.value.content=e)},null,8,["modelValue"])]),v("div",H,[i($,{onClick:te,Border:""},{default:c(()=>[p(g(0!=le.value.id?e.$t("b.que-ren-xiu-gai"):e.$t("b.que-ren-tian-jia")),1)]),_:1}),i($,{onClick:l[6]||(l[6]=e=>Q.value=!1),Border:""},{default:c(()=>[p(g(e.$t("b.qu-xiao")),1)]),_:1})])];var a}),_:1})]),_:1},8,["modelValue"]),i(j,{modelValue:X.value,"onUpdate:modelValue":l[10]||(l[10]=e=>X.value=e),offOverflow:""},{default:c(()=>[i(x,{class:"max-h-[80vh] overflow-y-auto w-2xl"},{default:c(()=>[v("span",J,g(e.$t("b.shan-chu")),1),v("div",K,[v("span",null,g(e.$t("d.ming-cheng")),1),v("span",P,g(le.value.title),1)]),v("div",R,[i($,{onClick:l[8]||(l[8]=e=>ue()),Border:"",class:"text-error border-error"},{default:c(()=>[p(g(e.$t("b.que-ren-shan-chu")),1)]),_:1}),i($,{onClick:l[9]||(l[9]=e=>X.value=!1),Border:""},{default:c(()=>[p(g(e.$t("b.qu-xiao")),1)]),_:1})])]),_:1})]),_:1},8,["modelValue"])],64))}});export{W as default};
